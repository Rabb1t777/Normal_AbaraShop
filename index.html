<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AbaraShop | –ö–∞—Ç–∞–ª–æ–≥</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #f8f9fa;
            --card-bg: #ffffff;
            --text: #212529;
            --text-secondary: #6c757d;
            --border: #e9ecef;
            --primary: #0a2463;
            --accent: #8b0000;
            --success: #28a745;
            --gray-light: #f1f3f4;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            padding-bottom: 80px;
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 16px;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            margin-bottom: 20px;
        }

        .header-title {
            font-size: 20px;
            font-weight: 600;
        }

        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
        }

        .tab-btn {
            flex: 1;
            padding: 8px 12px;
            background: var(--gray-light);
            border: none;
            border-radius: 8px;
            font-size: 14px;
            color: var(--text-secondary);
            cursor: pointer;
            text-align: center;
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
        }

        /* –ö–∞—Ç–µ–≥–æ—Ä–∏—è */
        .category-section {
            margin-bottom: 24px;
        }

        .category-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-title a {
            color: var(--primary);
            font-size: 14px;
            text-decoration: none;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .category-card {
            background: var(--card-bg);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s;
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-4px);
        }

        .category-img {
            height: 140px;
            background-color: #f1f3f4;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .category-name {
            padding: 12px;
            font-weight: 600;
            text-align: center;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .product-card {
            background: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.2s;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-img {
            width: 100%;
            height: 200px;
            background-color: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .product-content {
            padding: 15px;
        }

        .product-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .product-price {
            font-weight: 700;
            font-size: 18px;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .product-old-price {
            text-decoration: line-through;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .product-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .like-button {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 18px;
            cursor: pointer;
            transition: color 0.2s;
        }

        .like-button.liked {
            color: #e53e3e !important;
        }

        .add-to-cart-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            font-weight: 600;
        }

        /* –°–µ–∫—Ü–∏—è "–û–¥–µ–∂–¥–∞" ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ */
        .section-title {
            font-size: 20px;
            font-weight: 600;
            margin: 24px 0 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 12px;
            cursor: pointer;
            width: 20%;
            position: relative;
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        /* –ë–µ–π–¥–∂ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã */
        .cart-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: var(--accent);
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ */
        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* –î–ª—è –ø—Ä–æ—Ñ–∏–ª—è */
        .profile-section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .profile-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .profile-avatar {
            width: 60px;
            height: 60px;
            background: #e9ecef;
            border-radius: 50%;
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--text-secondary);
        }

        .profile-name {
            font-weight: 600;
            font-size: 16px;
        }

        .profile-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
        }

        .profile-item:last-child {
            border-bottom: none;
        }

        .profile-item .icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f1f3f4;
            border-radius: 6px;
            margin-right: 12px;
        }

        .profile-item .value {
            color: var(--primary);
            font-weight: 600;
        }

        /* –ö–æ—Ä–∑–∏–Ω–∞ */
        .cart-empty {
            text-align: center;
            padding: 40px 0;
            color: var(--text-secondary);
        }

        .cart-item {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            display: flex;
            gap: 16px;
        }

        .cart-item-img {
            width: 80px;
            height: 80px;
            background: #f1f3f4;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .cart-item-price {
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 8px;
        }

        .cart-item-actions {
            display: flex;
            gap: 8px;
        }

        .cart-remove-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }

        .cart-total {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
            text-align: right;
            font-size: 18px;
            font-weight: 700;
        }

        .checkout-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px;
            font-size: 18px;
            font-weight: 600;
            width: 100%;
            margin-top: 20px;
            cursor: pointer;
        }

        /* –£–ª—É—á—à–µ–Ω–∏–µ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #121212;
                --card-bg: #1e1e1e;
                --text: #e0e0e0;
                --text-secondary: #a0a0a0;
                --border: #333;
                --gray-light: #2a2a2a;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–ö–∞—Ç–∞–ª–æ–≥) -->
        <div id="catalog-section" class="section active">
            <div class="header">
                <div class="header-title">–ö–∞—Ç–∞–ª–æ–≥</div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∏ –ú—É–∂—á–∏–Ω–∞–º / –ñ–µ–Ω—â–∏–Ω–∞–º -->
            <div class="tabs">
                <button class="tab-btn active" data-tab="men">–ú—É–∂—á–∏–Ω–∞–º</button>
                <button class="tab-btn" data-tab="women">–ñ–µ–Ω—â–∏–Ω–∞–º</button>
            </div>

            <!-- –û–±—É–≤—å -->
            <div class="category-section">
                <div class="category-title">
                    <span>–û–±—É–≤—å</span>
                    <a href="#" onclick="showProducts('obuv')">–í—Å–µ ‚Üí</a>
                </div>
                <div class="category-grid">
                    <div class="category-card" onclick="showProducts('krossovki')">
                        <div class="category-img">üëü</div>
                        <div class="category-name">–ö—Ä–æ—Å—Å–æ–≤–∫–∏ –∏ –∫–µ–¥—ã</div>
                    </div>
                    <div class="category-card" onclick="showProducts('botinki')">
                        <div class="category-img">ü•æ</div>
                        <div class="category-name">–ë–æ—Ç–∏–Ω–∫–∏</div>
                    </div>
                    <div class="category-card" onclick="showProducts('custom')">
                        <div class="category-img">üé®</div>
                        <div class="category-name">–ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏</div>
                    </div>
                    <div class="category-card" onclick="showProducts('sport')">
                        <div class="category-img">üèÉ</div>
                        <div class="category-name">–û–±—É–≤—å –¥–ª—è —Å–ø–æ—Ä—Ç–∞</div>
                    </div>
                    <div class="category-card" onclick="showProducts('tapki')">
                        <div class="category-img">üë°</div>
                        <div class="category-name">–¢–∞–ø–∫–∏</div>
                    </div>
                    <div class="category-card" onclick="showProducts('sapogi')">
                        <div class="category-img">üë¢</div>
                        <div class="category-name">–°–∞–ø–æ–≥–∏</div>
                    </div>
                </div>
            </div>

            <!-- –û–¥–µ–∂–¥–∞ -->
            <div class="category-section">
                <div class="category-title">
                    <span>–û–¥–µ–∂–¥–∞</span>
                    <a href="#" onclick="showProducts('odezhda')">–í—Å–µ ‚Üí</a>
                </div>
                <div class="category-grid">
                    <div class="category-card" onclick="showProducts('verhnyaya')">
                        <div class="category-img">üß•</div>
                        <div class="category-name">–í–µ—Ä—Ö–Ω—è—è –æ–¥–µ–∂–¥–∞</div>
                    </div>
                    <div class="category-card" onclick="showProducts('futbolki')">
                        <div class="category-img">üëï</div>
                        <div class="category-name">–§—É—Ç–±–æ–ª–∫–∏</div>
                    </div>
                    <div class="category-card" onclick="showProducts('shorty')">
                        <div class="category-img">ü©≥</div>
                        <div class="category-name">–®–æ—Ä—Ç—ã</div>
                    </div>
                    <div class="category-card" onclick="showProducts('accessories')">
                        <div class="category-img">üß£</div>
                        <div class="category-name">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
        <div id="products-section" class="section">
            <div class="header">
                <div class="header-title" id="products-title">–¢–æ–≤–∞—Ä—ã</div>
            </div>
            <div class="product-grid" id="products-container">
                <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å—é–¥–∞ -->
            </div>
        </div>

        <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
        <div id="profile-section" class="section">
            <div class="header">
                <div class="header-title">–ü—Ä–æ—Ñ–∏–ª—å</div>
            </div>

            <div class="profile-section">
                <div class="profile-header">
                    <div class="profile-avatar">üë§</div>
                    <div class="profile-name" id="user-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                </div>

                <!-- –†–∞–±–æ—á–∏–µ –∫–Ω–æ–ø–∫–∏ -->
                <div class="profile-item" onclick="setEmoji()">
                    <div class="icon">üí¨</div>
                    <span>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å AbaraShop —ç–º–æ–¥–∑–∏</span>
                </div>
                <div class="profile-item" onclick="addToHomeScreen()">
                    <div class="icon">‚ûï</div>
                    <span>–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω ¬´–î–æ–º–æ–π¬ª</span>
                </div>
                <div class="profile-item" onclick="requestContact()">
                    <div class="icon">üìû</div>
                    <span>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</span>
                </div>

                <p style="font-size: 12px; color: var(--text-secondary); margin: 16px 0;">
                    –°—Ç–∞—Ä—ã–µ –∑–∞–∫–∞–∑—ã –ø–æ—è–≤—è—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã –¥–æ–±–∞–≤–∏—Ç–µ —Å–≤–æ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
                </p>

                <div class="profile-item" onclick="setShippingAddress()">
                    <div class="icon">üìç</div>
                    <span>–î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç–∞–≤–∫–∏</span>
                    <span class="value">‚Üí</span>
                </div>
                <div class="profile-item" onclick="setCustomsData()">
                    <div class="icon">üì¶</div>
                    <span>–î–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–º–æ–∂–Ω–∏</span>
                    <span class="value">‚Üí</span>
                </div>
                <div class="profile-item" onclick="inviteFriend()">
                    <div class="icon">üë•</div>
                    <span>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞</span>
                    <span class="value">+500 ‚ÇΩ ‚Üí</span>
                </div>
                <div class="profile-item" onclick="openSupport()">
                    <div class="icon">‚öôÔ∏è</div>
                    <span>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</span>
                    <span class="value">‚Üí</span>
                </div>

                <div class="profile-item" onclick="switchPage('orders')">
                    <div class="icon">üõí</div>
                    <span>–ó–∞–∫–∞–∑—ã</span>
                    <span class="value">0 ‚Üí</span>
                </div>
                <div class="profile-item" onclick="switchPage('reviews')">
                    <div class="icon">‚≠ê</div>
                    <span>–û—Ç–∑—ã–≤—ã</span>
                    <span class="value">‚Üí</span>
                </div>
                <div class="profile-item" onclick="switchPage('favorites')">
                    <div class="icon">‚ù§Ô∏è</div>
                    <span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                    <span class="value">‚Üí</span>
                </div>
                <div class="profile-item" onclick="switchPage('viewed')">
                    <div class="icon">üëÄ</div>
                    <span>–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</span>
                    <span class="value">‚Üí</span>
                </div>

                <div class="profile-item">
                    <div class="icon">üèÜ</div>
                    <span>–°—Ç–∞—Ç—É—Å</span>
                    <span class="value">–ù–æ–≤–∏—á–æ–∫ ‚Üí</span>
                </div>
                <div class="profile-item">
                    <div class="icon">üí∞</div>
                    <span>–ë–∞–ª–∞–Ω—Å</span>
                    <span class="value">0 ‚ÇΩ ‚Üí</span>
                </div>
            </div>
        </div>

        <!-- –ò–∑–±—Ä–∞–Ω–Ω–æ–µ -->
        <div id="favorites-section" class="section">
            <div class="header">
                <div class="header-title">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
            </div>
            <div id="favorites-container">
                <!-- –ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã -->
            </div>
        </div>

        <!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
        <div id="cart-section" class="section">
            <div class="header">
                <div class="header-title">–ö–æ—Ä–∑–∏–Ω–∞</div>
            </div>
            <div id="cart-container">
                <!-- –¢–æ–≤–∞—Ä—ã –∫–æ—Ä–∑–∏–Ω—ã -->
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω–∞—è (–¥–æ–º–∞—à–Ω—è—è) -->
        <div id="home-section" class="section">
            <div class="header">
                <div class="header-title">–ì–ª–∞–≤–Ω–∞—è</div>
            </div>
            <p style="text-align: center; padding: 40px 0; color: var(--text-secondary);">
                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ AbaraShop!  
                –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ <strong>–ö–∞—Ç–∞–ª–æ–≥</strong>, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–æ–∫—É–ø–∫–∏.
            </p>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="nav-bar">
        <div class="nav-item active" data-page="home">
            <div class="nav-icon">üè†</div>
            <span>–ì–ª–∞–≤–Ω–∞—è</span>
        </div>
        <div class="nav-item" data-page="catalog">
            <div class="nav-icon">üìã</div>
            <span>–ö–∞—Ç–∞–ª–æ–≥</span>
        </div>
        <div class="nav-item" data-page="favorites">
            <div class="nav-icon">‚ù§Ô∏è</div>
            <span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
        </div>
        <div class="nav-item" data-page="cart">
            <div class="nav-icon">üõí</div>
            <span>–ö–æ—Ä–∑–∏–Ω–∞</span>
            <div class="cart-badge" id="cart-count">0</div>
        </div>
        <div class="nav-item" data-page="profile">
            <div class="nav-icon">üë§</div>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // –¢–µ–º–∞
        if (tg.colorScheme === 'dark') {
            document.documentElement.style.setProperty('--bg', '#121212');
            document.documentElement.style.setProperty('--card-bg', '#1e1e1e');
            document.documentElement.style.setProperty('--text', '#e0e0e0');
            document.documentElement.style.setProperty('--text-secondary', '#a0a0a0');
            document.documentElement.style.setProperty('--border', '#333');
            document.documentElement.style.setProperty('--gray-light', '#2a2a2a');
        }

        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
        let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
        let cart = JSON.parse(localStorage.getItem('cart') || '[]');

        // –ë–∞–∑–∞ —Ç–æ–≤–∞—Ä–æ–≤
        const products = {
            krossovki: [
                { id: 'nike-af1', name: 'Nike Air Force 1 \'07 Black', price: 11990, category: '–ö—Ä–æ—Å—Å–æ–≤–∫–∏' },
                { id: 'adidas-ss', name: 'Adidas Superstar', price: 10990, category: '–ö—Ä–æ—Å—Å–æ–≤–∫–∏' },
                { id: 'nb-2002r', name: 'New Balance 2002R', price: 12490, category: '–ö—Ä–æ—Å—Å–æ–≤–∫–∏' }
            ],
            botinki: [
                { id: 'timberland', name: 'Timberland 6 Inch Basic', price: 11990, category: '–ë–æ—Ç–∏–Ω–∫–∏' }
            ],
            custom: [
                { id: 'custom-nike', name: 'Custom Nike Air Force', price: 15990, category: '–ö–∞—Å—Ç–æ–º' }
            ],
            sport: [
                { id: 'nike-running', name: 'Nike Running Shoes', price: 9990, category: '–°–ø–æ—Ä—Ç' }
            ],
            tapki: [
                { id: 'slides', name: 'Adidas Slides', price: 3990, category: '–¢–∞–ø–∫–∏' }
            ],
            sapogi: [
                { id: 'winter-boots', name: 'Winter Boots', price: 14990, category: '–°–∞–ø–æ–≥–∏' }
            ],
            verhnyaya: [
                { id: 'jacket', name: 'Winter Jacket', price: 18990, category: '–í–µ—Ä—Ö–Ω—è—è –æ–¥–µ–∂–¥–∞' }
            ],
            futbolki: [
                { id: 't-shirt', name: 'Cotton T-Shirt', price: 2990, category: '–§—É—Ç–±–æ–ª–∫–∏' }
            ],
            shorty: [
                { id: 'shorts', name: 'Summer Shorts', price: 3490, category: '–®–æ—Ä—Ç—ã' }
            ],
            accessories: [
                { id: 'cap', name: 'Baseball Cap', price: 1990, category: '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã' }
            ]
        };

        // –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        const categoryNames = {
            krossovki: '–ö—Ä–æ—Å—Å–æ–≤–∫–∏ –∏ –∫–µ–¥—ã',
            botinki: '–ë–æ—Ç–∏–Ω–∫–∏',
            custom: '–ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏',
            sport: '–û–±—É–≤—å –¥–ª—è —Å–ø–æ—Ä—Ç–∞',
            tapki: '–¢–∞–ø–∫–∏',
            sapogi: '–°–∞–ø–æ–≥–∏',
            verhnyaya: '–í–µ—Ä—Ö–Ω—è—è –æ–¥–µ–∂–¥–∞',
            futbolki: '–§—É—Ç–±–æ–ª–∫–∏',
            shorty: '–®–æ—Ä—Ç—ã',
            accessories: '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã',
            obuv: '–û–±—É–≤—å',
            odezhda: '–û–¥–µ–∂–¥–∞'
        };

        // –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        let currentState = { page: 'catalog', currentCategory: null };

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü
        function switchPage(page) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            const targetSection = document.getElementById(page + '-section');
            if (targetSection) {
                targetSection.classList.add('active');
            } else {
                document.getElementById('catalog-section').classList.add('active');
            }

            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.page === page) {
                    item.classList.add('active');
                }
            });

            currentState.page = page;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
            if (page === 'profile') {
                updateProfileName();
            } else if (page === 'favorites') {
                renderFavorites();
            } else if (page === 'cart') {
                renderCart();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function showProducts(category) {
            currentState.currentCategory = category;
            document.getElementById('products-title').textContent = categoryNames[category] || '–¢–æ–≤–∞—Ä—ã';
            
            let productsToShow = [];
            if (category === 'obuv') {
                productsToShow = [...products.krossovki, ...products.botinki, ...products.custom, ...products.sport, ...products.tapki, ...products.sapogi];
            } else if (category === 'odezhda') {
                productsToShow = [...products.verhnyaya, ...products.futbolki, ...products.shorty, ...products.accessories];
            } else {
                productsToShow = products[category] || [];
            }

            const container = document.getElementById('products-container');
            if (productsToShow.length === 0) {
                container.innerHTML = '<p style="text-align:center; padding:40px; color:var(--text-secondary);">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
            } else {
                container.innerHTML = productsToShow.map(product => `
                    <div class="product-card">
                        <div class="product-img">${product.name.split(' ')[0]}</div>
                        <div class="product-content">
                            <div class="product-title">${product.name}</div>
                            <div class="product-price">${product.price.toLocaleString()} ‚ÇΩ</div>
                            <div class="product-actions">
                                <button class="like-button ${favorites.includes(product.id) ? 'liked' : ''}" 
                                        onclick="toggleFavorite('${product.id}', this)">
                                    ‚ô•
                                </button>
                                <button class="add-to-cart-btn" onclick="addToCart('${product.id}')">
                                    –í –∫–æ—Ä–∑–∏–Ω—É
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            switchPage('products');
        }

        // –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
        function addToCart(productId) {
            const product = Object.values(products).flat().find(p => p.id === productId);
            if (product) {
                const existing = cart.find(item => item.id === productId);
                if (existing) {
                    existing.quantity += 1;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                saveCart();
                updateCartBadge();
                tg.showAlert('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!');
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
        function toggleFavorite(productId, button) {
            const index = favorites.indexOf(productId);
            if (index > -1) {
                favorites.splice(index, 1);
                button.classList.remove('liked');
                tg.showAlert('–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ');
            } else {
                favorites.push(productId);
                button.classList.add('liked');
                tg.showAlert('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ!');
            }
            saveFavorites();
            if (currentState.page === 'favorites') {
                renderFavorites();
            }
        }

        // –£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveCart();
            updateCartBadge();
            renderCart();
            tg.showAlert('–¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã');
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        function saveFavorites() {
            localStorage.setItem('favorites', JSON.stringify(favorites));
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–π–¥–∂–∞ –∫–æ—Ä–∑–∏–Ω—ã
        function updateCartBadge() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = count;
            document.getElementById('cart-count').style.display = count > 0 ? 'flex' : 'none';
        }

        // –†–µ–Ω–¥–µ—Ä –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
        function renderFavorites() {
            const container = document.getElementById('favorites-container');
            const favProducts = Object.values(products).flat().filter(p => favorites.includes(p.id));
            
            if (favProducts.length === 0) {
                container.innerHTML = '<p style="text-align:center; padding:40px; color:var(--text-secondary);">–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º</p>';
            } else {
                container.innerHTML = `
                    <div class="product-grid">
                        ${favProducts.map(product => `
                            <div class="product-card">
                                <div class="product-img">${product.name.split(' ')[0]}</div>
                                <div class="product-content">
                                    <div class="product-title">${product.name}</div>
                                    <div class="product-price">${product.price.toLocaleString()} ‚ÇΩ</div>
                                    <div class="product-actions">
                                        <button class="like-button liked" onclick="toggleFavorite('${product.id}', this)">‚ô•</button>
                                        <button class="add-to-cart-btn" onclick="addToCart('${product.id}')">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
        }

        // –†–µ–Ω–¥–µ—Ä –∫–æ—Ä–∑–∏–Ω—ã
        function renderCart() {
            const container = document.getElementById('cart-container');
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            if (cart.length === 0) {
                container.innerHTML = '<p class="cart-empty">–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
            } else {
                container.innerHTML = `
                    ${cart.map(item => `
                        <div class="cart-item">
                            <div class="cart-item-img">${item.name.split(' ')[0]}</div>
                            <div class="cart-item-info">
                                <div class="cart-item-title">${item.name}</div>
                                <div class="cart-item-price">${(item.price * item.quantity).toLocaleString()} ‚ÇΩ</div>
                                <div class="cart-item-actions">
                                    <button class="cart-remove-btn" onclick="removeFromCart('${item.id}')">–£–¥–∞–ª–∏—Ç—å</button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                    <div class="cart-total">
                        –ò—Ç–æ–≥–æ: ${total.toLocaleString()} ‚ÇΩ
                    </div>
                    <button class="checkout-btn" onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
                `;
            }
        }

        // –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
        function checkout() {
            if (cart.length === 0) return;
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            tg.sendData(JSON.stringify({
                action: 'checkout',
                items: cart,
                total: total,
                timestamp: new Date().toISOString()
            }));
            tg.close();
        }

        // === –§–£–ù–ö–¶–ò–ò –ü–†–û–§–ò–õ–Ø ===

        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —ç–º–æ–¥–∑–∏
        function setEmoji() {
            tg.showAlert('–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram ‚Üí –≠–º–æ–¥–∑–∏ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ AbaraShop –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç.');
        }

        // –î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
        function addToHomeScreen() {
            if (tg.isVersionAtLeast(6, 4)) {
                tg.requestWriteAccess((ok) => {
                    if (ok) {
                        tg.showAlert('–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å Mini App –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —á–µ—Ä–µ–∑ –º–µ–Ω—é Telegram!');
                    } else {
                        tg.showAlert('–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω.');
                    }
                });
            } else {
                tg.showAlert('–û–±–Ω–æ–≤–∏—Ç–µ Telegram –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ –¥–ª—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.');
            }
        }

        // –ó–∞–ø—Ä–æ—Å–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç
        function requestContact() {
            if (tg.isVersionAtLeast(6, 7)) {
                tg.requestContact((user) => {
                    if (user) {
                        tg.showAlert(`–°–ø–∞—Å–∏–±–æ! –í–∞—à –Ω–æ–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω: ${user.phone_number || '‚Äî'}`);
                        tg.sendData(JSON.stringify({
                            action: 'save_phone',
                            phone: user.phone_number
                        }));
                    }
                });
            } else {
                tg.showAlert('–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ Telegram 8.7+');
            }
        }

        // –£–∫–∞–∑–∞—Ç—å –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏
        function setShippingAddress() {
            tg.showPopup({
                title: '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏',
                message: '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:',
                buttons: [{ type: 'default', text: '–û—Ç–º–µ–Ω–∞' }]
            }, (buttonId) => {
                if (buttonId !== 'cancel') {
                    tg.showAlert('–ê–¥—Ä–µ—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!');
                }
            });
        }

        // –î–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–º–æ–∂–Ω–∏
        function setCustomsData() {
            tg.showPopup({
                title: '–¢–∞–º–æ–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ',
                message: '–í–≤–µ–¥–∏—Ç–µ –§–ò–û –∏ –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤:',
                buttons: [{ type: 'default', text: '–û—Ç–º–µ–Ω–∞' }]
            }, (buttonId) => {
                if (buttonId !== 'cancel') {
                    tg.showAlert('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
                }
            });
        }

        // –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞
        function inviteFriend() {
            const botUsername = 'AbaraShop_bot'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à username
            const referralLink = `https://t.me/${botUsername}?start=ref_${tg.initDataUnsafe?.user?.id || 'user'}`;
            
            tg.shareToStory(referralLink, { 
                text: '–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ AbaraShop! –ü–æ–ª—É—á–∏ 500‚ÇΩ –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é üëü'
            }, () => {
                tg.showAlert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –µ—é —Å –¥—Ä—É–∑—å—è–º–∏.');
            });
        }

        // –û—Ç–∫—Ä—ã—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É
        function openSupport() {
            tg.openTelegramLink('https://t.me/AbaraShop_bot?start=support');
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                switchPage(item.dataset.page);
            });
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∫–ª–∞–¥–æ–∫
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
        tg.onEvent('backButtonClicked', () => {
            if (currentState.page === 'products') {
                switchPage('catalog');
            } else if (currentState.page !== 'catalog') {
                switchPage('catalog');
            } else {
                tg.close();
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function updateProfileName() {
            const user = tg.initDataUnsafe?.user;
            const nameEl = document.getElementById('user-name');
            if (user) {
                nameEl.textContent = `${user.first_name || ''} ${user.last_name || ''}`.trim() || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            }
        }

        updateProfileName();
        updateCartBadge();
    </script>
</body>
</html>
